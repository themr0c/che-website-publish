<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=",  ">
<title>Securing Che | Eclipse Che Documentation</title>
<link rel="stylesheet" href="/che/docs/css/syntax.css">
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="/che/docs/css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="/che/docs/css/customstyles.css">
<link rel="stylesheet" href="/che/docs/css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="/che/docs/css/theme-che.css">


    <link rel="stylesheet" href="/che/docs/css/coderay.css" media="screen" type="text/css">
    <link rel="stylesheet" href="/che/docs/css/asciidoc.css" type="text/css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js" crossorigin="anonymous"></script>
<script src="/che/docs/js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js" crossorigin="anonymous"></script>
<script src="/che/docs/js/toc.js"></script>
<script src="/che/docs/js/customscripts.js"></script>

<link rel="shortcut icon" href="/che/docs/images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="che" href="/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: false,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="/che/docs/">&nbsp;<span class="projectTitle"> Eclipse Che Documentation</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://medium.com/eclipse-che-blog/" target="_blank">Blog</a></li>
                
                
                
                <li><a href="https://github.com/eclipse/che" target="_blank">Source Code</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Che Version<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="/che/docs/che-6">Che 6</a></li>
                        
                        
                        
                        <li class="dropdownActive"><a href="/che/docs/che-7">Che 7</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Get Support<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/eclipse/che/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc+label%3Akind%2Fbug" target="_blank">Known Bugs</a></li>
                        
                        
                        
                        <li><a href="https://github.com/eclipse/che/issues/new" target="_blank">File an Issue</a></li>
                        
                        
                        
                        <li><a href="https://stackoverflow.com/questions/tagged/eclipse-che" target="_blank">Che on StackOverflow</a></li>
                        
                        
                    </ul>
                </li>
                
                
                <!-- 
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:?subject= feedback&body=I have some feedback about the Securing Che page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>
 -->
		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="/che/docs/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: "/che/docs/search.json",
                                searchResultTemplate: '<li><a href="{url}" title="Securing Che">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">Eclipse Che 7</li>
  
  <div class="sidebarSubtitle">Overview</div>
  
  
  <li>
      
      <a href="/che/docs/che-7/introduction-to-eclipse-che">Introduction to Che</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Che quick-starts</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/installing-the-chectl-management-tool">Installing the chectl management tool</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/running-che-locally">Running Che locally</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/deploying-che-on-kubernetes-on-aws">Che on Amazon Web Services</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/installing-che-on-openshift-3-using-the-operator">Che on OpenShift 3</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/installing-che-on-openshift-4-from-operatorhub">Che on OpenShift 4</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/installing-che-on-google-cloud-platform">Che on Google Cloud Platform</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/installing-eclipse-che-on-microsoft-azure">Che on Microsoft Azure</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che/docs/che-7/hosted-che">Hosted Che</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Che architecture</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/high-level-che-architecture">High-level Che architecture</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che-workspace-controller">Che workspace controller</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che-workspaces-architecture">Che workspaces architecture</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
  <div class="sidebarSubtitle">End-user Guide</div>
  
  
  <li>
      
      <a href="/che/docs/che-7/navigating-che-using-the-dashboard">Navigating Che: dashboard</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Che-Theia IDE basics</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/defining-custom-commands-for-che-theia">Defining custom commands for Che-Theia</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/version-control">Version Control</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Using developer workspaces</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/workspaces-overview">Workspaces overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/configuring-a-workspace-using-a-devfile">Configuring a workspace using a devfile</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/making-a-workspace-portable-using-a-devfile">Making a workspace portable using a devfile</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/converting-a-che-6-workspace-to-a-che-7-devfile">Converting a Che 6 Workspace to a Che 7 devfile</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/creating-and-configuring-a-new-che-7-workspace">Creating and configuring a new Che 7 workspace</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/importing-a-kubernetes-application-into-a-che-workspace">Importing a Kubernetes application into a Che workspace</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/remotely-accessing-che-workspaces">Remotely accessing workspaces</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/creating-a-workspace-from-code-sample">Creating a workspace from code sample</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/creating-a-workspace-by-importing-source-code-of-a-project">Creating a workspace by importing source code of a project</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Customizing developer environments</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/customizing-developer-environments">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/what-is-a-che-theia-plug-in">What is a Che-Theia plug-in</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/using-alternative-ides-in-che">Using alternative IDEs in Che</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/using-a-visual-studio-code-extension-in-che">Using a VS Code extension in Che</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
  <div class="sidebarSubtitle">Administration Guide</div>
  
  
  <li>
      
      <a href="#" class="expandable">Customizing devfile and plug-in registries</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/customizing-the-devfile-and-plug-in-registries">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/building-and-running-a-custom-registry-image">Building and running a custom registry image</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/including-the-plug-in-binaries-in-the-registry-image">Including the plug-in binaries in the registry image</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/editing-a-devfile-and-plug-in-at-runtime">Editing a devfile and plug-in at runtime</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Retrieving Che logs</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/retrieving-che-logs">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/viewing-kubernetes-events">Viewing Kubernetes events</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/viewing-che-server-logs">Viewing Che server logs</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/viewing-external-service-logs">Viewing external service logs</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/viewing-che-workspaces-logs">Viewing Che workspaces logs</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/viewing-plug-in-broker-logs">Viewing the plug-in broker logs</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che/docs/che-7/monitoring-che">Monitoring Che</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che/docs/che-7/tracing-che">Tracing Che</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Securing Che</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/authenticating-users">Authenticating users</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/authorizing-users">Authorizing users</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
  <div class="sidebarSubtitle">Contributor Guide</div>
  
  
  <li>
      
      <a href="/che/docs/che-7/developing-che-theia-plug-ins">Developing Che-Theia plug-ins</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che/docs/che-7/testing-che-theia-plug-ins">Testing Che-Theia plug-ins</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che/docs/che-7/publishing-che-theia-plug-ins">Publishing Che-Theia plug-ins</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che/docs/che-7/adding-support-for-a-new-language">Adding support for a new language</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che/docs/che-7/adding-support-for-a-new-debugger">Adding support for a new debugger</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Che extensibility reference</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/che-extensibility-reference">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che-extension-points">Che extension points</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che-theia-plug-in-api">Che-Theia plug-in API</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/debug-adapter-protocol">Debug Adapter Protocol</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/language-server-protocol">Language Server Protocol</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
  <div class="sidebarSubtitle">Extensions</div>
  
  
  <li>
      
      <a href="#" class="expandable">Eclipse Che4z</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/che4z-release-information">Release Information</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che4z-installing">Installing</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che4z-using-explorer-for-zos">Using z/OS Resource Explorer</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che4z-product-accessibility-features">Product Accessibility Features</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block: -->
         <p class="external">
             <a href="#" id="collapseAll">Collapse all</a> | <a href="#" id="expandAll">Expand all</a>
         </p>
         
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>

            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Securing Che</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.
$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2' });
/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top
  $(window).scrollTop(scroll_target - 10);
  return false
})

});
</script>

<div id="toc"></div>

    


    <!-- 


     -->

  <div id="preamble">
<div class="sectionbody">
<hr>
<div class="paragraph">
<p>title: Authenticating users
keywords:
tags: []
sidebar: che_7_docs
permalink: che-7/authenticating-users/
folder: che-7/administration-guide
summary:
---</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="authenticating-users">Authenticating users</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document covers all aspects of user authentication in Eclipse Che, both on the Che server and in workspaces. This includes securing all REST API endpoints, WebSocket or JSON RPC connections, and some web resources.</p>
</div>
<div class="paragraph">
<p>All authentication types use the <a href="https://jwt.io/introduction/">JWT open standard</a> as a container for transferring user identity information. In addition, Che server authentication is based on the <a href="https://openid.net/connect/">OpenID Connect</a> protocol implementation, which is provided by default by <a href="https://www.keycloak.org/">Keycloak</a>.</p>
</div>
<div class="paragraph">
<p>Authentication in workspaces implies the issuance of self-signed per-workspace JWT tokens and their verification on a dedicated service based on <a href="https://www.keycloak.org/">JWTProxy</a>.</p>
</div>
<div class="sect2">
<h3 id="authenticating-to-the-che-server">Authenticating to the Che server</h3>
<div class="sect3">
<h4 id="authenticating-to-the-che-server-using-openid_authenticating-to-the-che-server">Authenticating to the Che server using OpenID</h4>
<div class="paragraph">
<p>OpenID authentication on the Che server implies the presence of an external OpenID Connect provider and has the following main steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Authenticate the user through a JWT token that is retrieved from an HTTP request or, in case of a missing or invalid token, redirect the user to the Keycloak login page.</p>
</li>
<li>
<p>Send authentication tokens in an <strong>Authorization</strong> header. In limited cases, when it is not possible to use the <strong>Authorization</strong> header, the token can be sent in the token query parameter. Example: OAuth authentication initialization.</p>
</li>
<li>
<p>Compose an internal <code>subject</code> object that represents the current user inside the Che server code.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The only supported and tested OpenID provider is Keycloak.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To authenticate to the Che server using OpenID authentication:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Request the OpenID settings service where clients can find all the necessary URLs and properties of the OpenId provider, such as <code>jwks.endpoint</code>, <code>token.endpoint</code>, <code>logout.endpoint</code>, <code>realm.name</code>, or <code>client_id</code> returned in the JSON format.</p>
</li>
<li>
<p>The service URL is <code><em>&lt;che.host&gt;</em>:<em>&lt;che.port&gt;</em>/api/keycloak/settings</code>, and it is only available in the Che multi-user mode. The presence of the service in the URL confirms that the authentication is enabled in the current deployment.</p>
<div class="paragraph">
<p>Example output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
    <span style="color:#606"><span style="color:#404">&quot;</span><span>che.keycloak.token.endpoint</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://172.19.20.9:5050/auth/realms/che/protocol/openid-connect/token</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>che.keycloak.profile.endpoint</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://172.19.20.9:5050/auth/realms/che/account</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>che.keycloak.client_id</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">che-public</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>che.keycloak.auth_server_url</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://172.19.20.9:5050/auth</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>che.keycloak.password.endpoint</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://172.19.20.9:5050/auth/realms/che/account/password</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>che.keycloak.logout.endpoint</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://172.19.20.9:5050/auth/realms/che/protocol/openid-connect/logout</span><span style="color:#710">&quot;</span></span>,
    <span style="color:#606"><span style="color:#404">&quot;</span><span>che.keycloak.realm</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">che</span><span style="color:#710">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The service allows downloading the JavaScript client library to interact with the provider using the <code>&lt;che.host&gt;:&lt;che.port&gt;/api/keycloak/OIDCKeycloak.js</code> URL.</p>
</div>
</li>
<li>
<p>Redirect the user to the appropriate provider&#8217;s login page with all the necessary parameters, including <code>client_id</code> and the return redirection path. This can be done with any client library (JS or Java).</p>
</li>
<li>
<p>When the user is logged in to the provider, the client side-code is obtained, and the JWT token has validated the token, the creation of the <code>subject</code> begins.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The verification of the token signature occurs in two main steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Authentication: The token is extracted from the <strong>Authorization</strong> header or from the <code>token</code> query parameter and is parsed using the public key retrieved from the provider. In case of expired, invalid, or malformed tokens, a <code>403</code> error is sent to the user. The use of the query parameter should be minimised because its support may be limited or removed in future versions.</p>
<div class="paragraph">
<p>If the validation is successful, the parsed form of the token is passed to the environment initialization step:</p>
</div>
</li>
<li>
<p>Environment initialization: The filter extracts data from the JWT token claims, creates the user in the local database if it is not yet present, and constructs the <code>subject</code> object and sets it into the per-request <strong>EnvironmentContext</strong> object, which is statically accessible everywhere.</p>
<div class="paragraph">
<p>If the request was made using only a machine token, the following single authentication filter is used:</p>
</div>
<div class="paragraph">
<p><strong>org.eclipse.che.multiuser.machine.authentication.server.MachineLoginFilter</strong>: The filter finds the user that the <code>userId</code> token belongs to, retrieves the user instance, and sets the principal to the session. The Che server-to-server requests are performed using a dedicated request factory that signs every request with the current subject token obtained from the <code>EnvironmentContext</code> object.</p>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<div class="title">Providing user-specific data</div>
<p>Since Keycloak may store user-specific information (first and last name, phone number, job title), there is a special implementation of the <strong>ProfileDao</strong> that can provide this data to consumers. The implementation is read-only, so users cannot perform create and update operations.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="obtaining-the-token-from-keycloak_authenticating-to-the-che-server">Obtaining the token from credentials through Keycloak</h5>
<div class="paragraph">
<p>Clients that cannot run JavaScript or other clients (such as command-line clients or Selenium tests) must request the authorization token directly from Keycloak.</p>
</div>
<div class="paragraph">
<p>To obtain the token, send a request to the token endpoint with the username and password credentials. This request can be schematically described as the following cURL request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl --data "grant_type=password&amp;client_id=<em>&lt;client_name&gt;</em>&amp;username=<em>&lt;username&gt;</em>&amp;password=<em>&lt;password&gt;</em>" \
  http://&lt;keyckloak_host&gt;:5050/auth/realms/<em>&lt;realm_name&gt;</em>/protocol/openid-connect/token</pre>
</div>
</div>
<div class="paragraph">
<p>The Che dashboard uses a customized Keycloak login page and an authentication mechanism based on <code>grant_type=authorization_code</code>. It is a two-step authentication process:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Logging in and obtaining the authorization code.</p>
</li>
<li>
<p>Obtaining the token using this authorization code.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="obtaining-the-token-from-openshift-token-through-keycloak_authenticating-to-the-che-server">Obtaining the token from the OpenShift token through Keycloak</h5>
<div class="paragraph">
<p>When Che has been installed on OpenShift using the Operator, and the OpenShift OAuth integration has been enabled (it is by default),
then the Che authentication token of a user can also be retrieved from the user OpenShift token.</p>
</div>
<div class="paragraph">
<p>To do this, send a request to the token endpoint that can be schematically described as the following cURL request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -X POST -d "client_id=<em>&lt;client_name&gt;</em>" \
--data-urlencode "grant_type=urn:ietf:params:oauth:grant-type:token-exchange" \
-d "subject_token=<em>&lt;user_openshift_token&gt;</em>" \
 -d "subject_issuer=<em>&lt;openshift_identity_provider_name&gt;</em>" \
 --data-urlencode "subject_token_type=urn:ietf:params:oauth:token-type:access_token" \
 http://&lt;keyckloak_host&gt;:5050/auth/realms/<em>&lt;realm_name&gt;</em>/protocol/openid-connect/token</pre>
</div>
</div>
<div class="paragraph">
<p>The default values for <code><em>&lt;openshift_identity_provider_name&gt;</em></code> are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On OpenShift 3.11: <code>openshift-v3</code></p>
</li>
<li>
<p>On OpenShift 4.x: <code>openshift-v4</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code><em>&lt;user_openshift_token&gt;</em></code> is the token retrieved by the end-user with the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ oc whoami --show-token</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Before using this token exchange feature for an end user, the end user should have logged in at least once interactively to the Che Dashboard through the OpenShift login page. This is required to properly link OpenShift and Keycloak user accounts, and set the required user profile information (email, first and last names).
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="authenticatinng-to-the-che-server-using-other-authentication-implementations_authenticating-to-the-che-server">Authenticating to the Che server using other authentication implementations</h4>
<div class="paragraph">
<p>This procedure describes how to use an OIDC authentication implementation other than Keycloak.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Update the authentication configuration parameters that are stored in the <code>multiuser.properties</code> file (such as client ID, authentication URL, realm name).</p>
</li>
<li>
<p>Write a single filter or a chain of filters to validate tokens, create the user in the Che dashboard, and compose the <code>subject</code> object.</p>
</li>
<li>
<p>If the new authorization provider supports the OpenID protocol, use the OIDC JS client library available at the settings endpoint because it is decoupled from specific implementations.</p>
</li>
<li>
<p>If the selected provider stores additional data about the user (first and last name, job title), it is recommended to write a provider-specific <strong>ProfileDao</strong> implementation that provides this information.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="authenticating-to-the-che-server-using-oauth_authenticating-to-the-che-server">Authenticating to the Che server using OAuth</h4>
<div class="paragraph">
<p>For easy user interaction with third-party services, the Che server supports OAuth authentication. OAuth tokens are also used for GitHub-related plug-ins.</p>
</div>
<div class="paragraph">
<p>OAuth authentication has two main flows: internal and external, which is based on the Keycloak brokering mechanism. The following are the two main OAuth API implementations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>org.eclipse.che.security.oauth.EmbeddedOAuthAPI</strong>, for the internal flow.</p>
</li>
<li>
<p><strong>org.eclipse.che.multiuser.keycloak.server.oauth2.DelegatedOAuthAPI</strong>, for the external flow.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use the <code>che.oauth.service_mode=<em>&lt;embedded|delegated&gt;</em></code> configuration property to switch between the two implementations. The main REST endpoint in the OAuth API is <strong>org.eclipse.che.security.oauth.OAuthAuthenticationService, which contains</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An authenticate method to start the OAuth authentication flow</p>
</li>
<li>
<p>A callback method to process callbacks from the provider</p>
</li>
<li>
<p>A token to retrieve the current user&#8217;s OAuth token</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These methods refer to the currently activated embedded or delegated OAuthAPI that does the underlying operations, including finding the appropriate authenticator, initializing the login process, and user forwarding.</p>
</div>
</div>
<div class="sect3">
<h4 id="using-swagger-or-rest-clients-to-execute-queries_authenticating-to-the-che-server">Using Swagger or REST clients to execute queries</h4>
<div class="paragraph">
<p>The user&#8217;s Keycloak token is used to execute queries to the secured API on the user&#8217;s behalf through REST clients. A valid token must be attached as the <strong>Request</strong> header or the <code>?token=$token</code> query parameter.</p>
</div>
<div class="paragraph">
<p>Access the Che Swagger interface at <code><a href="http://che_host:8080/swagger" class="bare">http://che_host:8080/swagger</a></code>. The user must be signed in through Keycloak, so that the access token is included in the <strong>Request</strong> header.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="authenticating-in-a-che-workspace">Authenticating in a Che workspace</h3>
<div class="paragraph">
<p>Workspace containers may contain services that must be protected with authentication. Such protected services are called <strong>secure</strong>. For this purpose, a machine authentication mechanism should be used. Machine tokens avoid the need to pass Keycloak tokens to workspace containers (which can be insecure). Also, Keycloak tokens may have a relatively shorter lifetime and require periodic renewals or refreshes, which is difficult to manage and keep in sync with the same user session tokens on clients.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/che/docs/images/security/authentication-inside-the-workspace.png" alt="authentication inside the workspace">
</div>
<div class="title">Figure 1. Authentication inside a workspace</div>
</div>
<div class="sect3">
<h4 id="creating-secure-servers_authenticating-in-a-che-workspace">Creating secure servers</h4>
<div class="paragraph">
<p>To create secure servers in Che workspaces, set the <code>secure</code> attribute of the endpoint to <code>true</code> in the <code>dockerimage</code> type component in the devfile.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">petclinic-dev-environment</span></span>
<span style="color:#606">components</span>:
  - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">type: dockerimage</span></span>
    <span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">eclipse/maven-jdk8:latest</span></span>
    <span style="color:#606">volumes</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: maven-repo</span></span>
        <span style="color:#606">containerPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/root/.m2</span></span>
        <span style="color:#606">env</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: ENV_VAR</span></span>
        <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">value</span></span>
        <span style="color:#606">endpoints</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: maven-server</span></span>
        <span style="color:#606">port</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">3101</span></span>
        <span style="color:#606">attributes</span>:
        <span style="color:#606">protocol</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">http</span></span>
        <span style="color:#606">secure</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'true'</span></span>
        <span style="color:#606">public</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'true'</span></span>
        <span style="color:#606">discoverable</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'false'</span></span>
        <span style="color:#606">memoryLimit</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1536M</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="workspace-jwt-token_authenticating-in-a-che-workspace">Workspace JWT token</h4>
<div class="paragraph">
<p>Workspace tokens are JSON web tokens (<a href="https://jwt.io/">JWT</a>) that contain the following information in their claims:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>uid</code>: The ID of the user who owns this token</p>
</li>
<li>
<p><code>uname</code>: The name of the user who owns this token</p>
</li>
<li>
<p><code>wsid</code>: The ID of a workspace which can be queried with this token</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Every user is provided with a unique personal token for each workspace. The structure of a token and the signature are different than they are in Keycloak. The following is an example token view:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><span style="color:#F00;background-color:#FAA">#</span> <span style="color:#F00;background-color:#FAA">H</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">d</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">r</span>
{
  <span style="color:#606"><span style="color:#404">&quot;</span><span>alg</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">RS512</span><span style="color:#710">&quot;</span></span>,
  <span style="color:#606"><span style="color:#404">&quot;</span><span>kind</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">machine_token</span><span style="color:#710">&quot;</span></span>
}
<span style="color:#F00;background-color:#FAA">#</span> <span style="color:#F00;background-color:#FAA">P</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">y</span><span style="color:#F00;background-color:#FAA">l</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">d</span>
{
  <span style="color:#606"><span style="color:#404">&quot;</span><span>wsid</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">workspacekrh99xjenek3h571</span><span style="color:#710">&quot;</span></span>,
  <span style="color:#606"><span style="color:#404">&quot;</span><span>uid</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">b07e3a58-ed50-4a6e-be17-fcf49ff8b242</span><span style="color:#710">&quot;</span></span>,
  <span style="color:#606"><span style="color:#404">&quot;</span><span>uname</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">john</span><span style="color:#710">&quot;</span></span>,
  <span style="color:#606"><span style="color:#404">&quot;</span><span>jti</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">06c73349-2242-45f8-a94c-722e081bb6fd</span><span style="color:#710">&quot;</span></span>
}
<span style="color:#F00;background-color:#FAA">#</span> <span style="color:#F00;background-color:#FAA">S</span><span style="color:#F00;background-color:#FAA">i</span><span style="color:#F00;background-color:#FAA">g</span><span style="color:#F00;background-color:#FAA">n</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">u</span><span style="color:#F00;background-color:#FAA">r</span><span style="color:#F00;background-color:#FAA">e</span>
{
  <span style="color:#606"><span style="color:#404">&quot;</span><span>value</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">RSASHA256(base64UrlEncode(header) + . +  base64UrlEncode(payload))</span><span style="color:#710">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The SHA-256 cipher with the RSA algorithm is used for signing machine tokens. It is not configurable. Also, there is no public service that distributes the public part of the key pair with which the token is signed.</p>
</div>
</div>
<div class="sect3">
<h4 id="machine-token-validation_authenticating-in-a-che-workspace">Machine token validation</h4>
<div class="paragraph">
<p>The validation of machine tokens is performed using a dedicated per-workspace service with <code>JWTProxy</code> running on it in a separate pod. When the workspace starts, this service receives the public part of the SHA key from the Che server. A separate verification endpoint is created for each secure server. When traffic comes to that endpoint, <code>JWTProxy</code> tries to extract the token from the cookies or headers and validates it using the public-key part.</p>
</div>
<div class="paragraph">
<p>To query the Che server, a workspace server can use the machine token provided in the <code>CHE_MACHINE_TOKEN</code> environment variable. This token is the user&#8217;s who starts the workspace. The scope of such requests is restricted to the current workspace only. The list of allowed operations is also strictly limited.</p>
</div>
<hr>
<div class="paragraph">
<p>title: Authorizing users
keywords:
tags: []
sidebar: che_7_docs
permalink: che-7/authorizing-users/
folder: che-7/administration-guide
summary:
---</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="authorizing-users">Authorizing users</h2>
<div class="sectionbody">
<div class="paragraph">
<p>User authorization in Che is based on the permissions model. Permissions are used to control the allowed actions of users and establish a security model. Every request is verified for the presence of the required permission in the current user subject after it passes authentication. You can control resources managed by Che and allow certain actions by assigning permissions to users.</p>
</div>
<div class="paragraph">
<p>Permissions can be applied to the following entities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Workspace</p>
</li>
<li>
<p>Organization</p>
</li>
<li>
<p>System</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All permissions can be managed using the provided REST API. The APIs are documented using Swagger at <code>[{host}/swagger/#!/permissions]</code>.</p>
</div>
<div class="sect2">
<h3 id="che-workspace-permissions_authorizing-users">Che workspace permissions</h3>
<div class="paragraph">
<p>The user who creates a workspace is the workspace owner. By default, the workspace owner has the following permissions: <code>read</code>, <code>use</code>, <code>run</code>, <code>configure</code>, <code>setPermissions</code>, and <code>delete</code>. Workspace owners can invite users into the workspace and control workspace permissions for other users.</p>
</div>
<div class="paragraph">
<p>The following permissions are associated with workspaces:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Che workspace permissions</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Permission</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows reading the workspace configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">use</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows using a workspace and interacting with it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">run</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows starting and stopping a workspace.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows defining and changing the workspace configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">setPermissions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows updating the workspace permissions for other users.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows deleting the workspace.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="che-organization-permissions_authorizing-users">Che organization permissions</h3>
<div class="paragraph">
<p>An Che organization is a named set of users. The following permissions are applicable to organizations:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Che organization permissions</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Permission</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">update</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows editing of the organization settings and information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows deleting an organization.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">manageSuborganizations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows creating and managing sub-organizations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">manageResources</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows redistribution of an organization&#8217;s resources and defining the resource limits.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">manageWorkspaces</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows creating and managing all the organization&#8217;s workspaces.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">setPermissions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows adding and removing users and updating their permissions.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="che-system-permissions_authorizing-users">Che system permissions</h3>
<div class="paragraph">
<p>Che system permissions control aspects of the whole Che installation. The following permissions are applicable to the system:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Che system permission</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Permission</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">manageSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows control of the system, workspaces, and organizations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">setPermissions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows updating the permissions for users on the system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">manageUsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows creating and managing users.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">monitorSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows accessing endpoints used for monitoring the state of the server.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All system permissions are granted to the administrative user who is configured in the <code>CHE_SYSTEM_ADMIN__NAME</code> property (the default is <code>admin</code>). The system permissions are granted when the Che server starts. If the user is not present in the Che user database, it happens after the first users login.</p>
</div>
</div>
<div class="sect2">
<h3 id="managesystem-permission_authorizing-users">manageSystem permission</h3>
<div class="paragraph">
<p>Users with the <strong>manageSystem</strong> permission have access to the following services:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Path</th>
<th class="tableblock halign-left valign-top">HTTP Method</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/resource/free/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get free resource limits.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/resource/free/{accountId}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get free resource limits for the given account.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/resource/free/{accountId}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Edit free resource limit for the given account.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/resource/free/{accountId}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remove free resource limit for the given account.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/installer/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add installer to the registry.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/installer/{key}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update installer in the registry.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/installer/{key}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remove installer from the registry.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/logger/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get logging configurations in the Che server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/logger/{name}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get configurations of logger by its name in the Che server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/logger/{name}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create logger in the Che server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/logger/{name}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Edit logger in the Che server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/resource/{accountId}/details</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get detailed information about resources for the given account.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/system/stop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shutdown all system services, prepare Che to stop.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="monitorsystem-permission_authorizing-users">monitorSystem permission</h3>
<div class="paragraph">
<p>Users with the <strong>monitorSystem</strong> permission have access to the following services.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Path</th>
<th class="tableblock halign-left valign-top">HTTP Method</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/activity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get workspaces in a certain state for a certain amount of time.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="super-privileged-mode_authorizing-users">super-privileged mode</h3>
<div class="paragraph">
<p>The <strong>manageSystem</strong> permission can be extended to provide a <strong>super-privileged</strong> mode. This allows the user to perform advanced actions on any resources managed by the system. A user can read and stop any workspace with the <strong>manageSystem</strong> permission and assign permissions to other users as needed.</p>
</div>
<div class="paragraph">
<p>The <strong>super-privileged</strong> mode is disabled by default. To change to the <strong>super-privileged</strong> mode, set the <code>CHE_SYSTEM_SUPER<em>PRIVILEGED</em>MODE</code> variable to <code>true</code> in the <code>che.env</code> file. The following is a list of services that are enabled for users with the <strong>manageSystems</strong> permissions and with <strong>super-privileged</strong> mode on.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Path</th>
<th class="tableblock halign-left valign-top">HTTP Method</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/workspace/namespace/{namespace:.*}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get all workspaces for the given namespace.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/workspace/{id}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stop a workspace.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/workspace/{key:.*}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get a workspace by key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/organization/resource/{suborganizationId}/cap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get a resource cap for the given organization.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/organization/resource/{suborganizationId}/cap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set the resource cap for a given organization.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/organization/{parent}/organizations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get the child organizations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/organization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get the user&#8217;s organizations.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="listing-che-permissions_authorizing-users">Listing Che permissions</h3>
<div class="paragraph">
<p>To list Che permissions that apply to a specific <strong>resource</strong>, perform the <code>GET /permissions</code> request.</p>
</div>
<div class="paragraph">
<p>To list the permissions that apply to a <strong>user</strong>, perform the <code>GET /permissions/{domain}</code> request.</p>
</div>
<div class="paragraph">
<p>To list the permissions that apply to <strong>all users</strong>, perform the <code>GET /permissions/{domain}/all</code>  request. The user must have <strong>manageSystem</strong> permissions to see this information.</p>
</div>
<div class="paragraph">
<p>The suitable domain values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>system</p>
</li>
<li>
<p>organization</p>
</li>
<li>
<p>workspace</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The domain is optional. If no domain is specified, the API returns all possible permissions for all the domains.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="assigning-che-permissions_authorizing-users">Assigning Che permissions</h3>
<div class="paragraph">
<p>To assign permissions to a resource, perform the <code>POST /permissions</code> request. The suitable domain values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>system</p>
</li>
<li>
<p>organization</p>
</li>
<li>
<p>workspace</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is a message body that requests permissions for a user with a <code>userID</code> to a workspace with a <code>workspaceID</code>:</p>
</div>
<div class="listingblock">
<div class="title">Requesting Che user permissions</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span style="color:#606"><span style="color:#404">&quot;</span><span>actions</span><span style="color:#404">&quot;</span></span>: [
    <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">read</span><span style="color:#710">&quot;</span></span>,
    <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">use</span><span style="color:#710">&quot;</span></span>,
    <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">run</span><span style="color:#710">&quot;</span></span>,
    <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">configure</span><span style="color:#710">&quot;</span></span>,
    <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">setPermissions</span><span style="color:#710">&quot;</span></span>
  ],
  <span style="color:#606"><span style="color:#404">&quot;</span><span>userId</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userID</span><span style="color:#710">&quot;</span></span>,          <i class="conum" data-value="1"></i><b>(1)</b>
  <span style="color:#606"><span style="color:#404">&quot;</span><span>domainId</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">workspace</span><span style="color:#710">&quot;</span></span>,
  <span style="color:#606"><span style="color:#404">&quot;</span><span>instanceId</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">workspaceID</span><span style="color:#710">&quot;</span></span>  <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <strong>userId</strong> parameter is the ID of the user that has been granted certain permissions.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <strong>instanceId</strong> parameter is the ID of the resource that retrieves the permission for all users.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sharing-che-permissions_authorizing-users">Sharing Che permissions</h3>
<div class="paragraph">
<p>A user with <strong>setPermissions</strong> privileges can share a workspace and grant <code>read</code>, <code>use</code>, <code>run</code>, <code>configure</code>, or <code>setPermissions</code> privileges for other users.</p>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To share workspace permissions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select a workspace in the user dashboard.</p>
</li>
<li>
<p>Navigate to the <strong>Share</strong> tab and enter the email IDs of the users. Use commas or spaces as separators for multiple emails.</p>
</li>
</ol>
</div>
</div>
</div>
</div>

    <div class="tags">
        
        <b>Tags: </b>
        
        
        
    </div>

<!-- 
 -->

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
                    Eclipse Che - Documentation <br/>
                    Site last generated: Oct 14, 2019 <br/>
                    <hr>
                    <a href="http://www.eclipse.org" target="_blank">Eclipse Foundation</a><br/>
                    <a href="http://www.eclipse.org/legal/privacy.php" target="_blank">Privacy Policy</a><br/>
                    <a href="http://www.eclipse.org/legal/termsofuse.php" target="_blank">Terms of Use</a><br/>
                    <a href="https://www.eclipse.org/legal/epl-2.0/" target="_blank">Eclipse Public License</a><br/>
                    <a href="http://www.eclipse.org/legal" target="_blank">Legal Resources</a><br/>
                </div>
            </div>
</footer>




    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>

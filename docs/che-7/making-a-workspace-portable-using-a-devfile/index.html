<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=",  ">
<title>Making a workspace portable using a Devfile | Eclipse Che Documentation</title>
<link rel="stylesheet" href="/che/docs/css/syntax.css">
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="/che/docs/css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="/che/docs/css/customstyles.css">
<link rel="stylesheet" href="/che/docs/css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="/che/docs/css/theme-che.css">


    <link rel="stylesheet" href="/che/docs/css/coderay.css" media="screen" type="text/css">
    <link rel="stylesheet" href="/che/docs/css/asciidoc.css" type="text/css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js" crossorigin="anonymous"></script>
<script src="/che/docs/js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js" crossorigin="anonymous"></script>
<script src="/che/docs/js/toc.js"></script>
<script src="/che/docs/js/customscripts.js"></script>

<link rel="shortcut icon" href="/che/docs/images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="che" href="/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: false,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="/che/docs/">&nbsp;<span class="projectTitle"> Eclipse Che Documentation</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://medium.com/eclipse-che-blog/" target="_blank">Blog</a></li>
                
                
                
                <li><a href="https://github.com/eclipse/che" target="_blank">Source Code</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Che Version<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="/che/docs/che-6">Che 6</a></li>
                        
                        
                        
                        <li class="dropdownActive"><a href="/che/docs/che-7">Che 7</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Get Support<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/eclipse/che/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc+label%3Akind%2Fbug" target="_blank">Known Bugs</a></li>
                        
                        
                        
                        <li><a href="https://github.com/eclipse/che/issues/new" target="_blank">File an Issue</a></li>
                        
                        
                        
                        <li><a href="https://stackoverflow.com/questions/tagged/eclipse-che" target="_blank">Che on StackOverflow</a></li>
                        
                        
                    </ul>
                </li>
                
                
                <!-- 
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:?subject= feedback&body=I have some feedback about the Making a workspace portable using a Devfile page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>
 -->
		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="/che/docs/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: "/che/docs/search.json",
                                searchResultTemplate: '<li><a href="{url}" title="Making a workspace portable using a Devfile">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">Eclipse Che 7</li>
  
  <div class="sidebarSubtitle">Overview</div>
  
  
  <li>
      
      <a href="/che/docs/che-7/introduction-to-eclipse-che">Introduction to Che</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Che quick-starts</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/che-quick-starts">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/installing-the-chectl-management-tool">Installing the chectl management tool</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/running-che-locally">Running Che locally</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/deploying-che-on-kubernetes-on-aws">Che on Amazon Web Services</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/installing-che-on-openshift-3-using-the-operator">Che on OpenShift 3</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/installing-che-on-openshift-4-from-operatorhub">Che on OpenShift 4</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/installing-che-on-google-cloud-platform">Che on Google Cloud Platform</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/installing-eclipse-che-on-microsoft-azure">Che on Microsoft Azure</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che/docs/che-7/hosted-che">Hosted Che</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Che architecture</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/che-architecture">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/high-level-che-architecture">High-level Che architecture</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che-workspace-controller">Che workspace controller</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che-workspaces-architecture">Che workspaces architecture</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
  <div class="sidebarSubtitle">End-user Guide</div>
  
  
  <li>
      
      <a href="/che/docs/che-7/navigating-che-using-the-dashboard">Navigating Che: dashboard</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Che-Theia IDE basics</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/che-theia-ide-basics">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/defining-custom-commands-for-che-theia">Defining custom commands for Che-Theia</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/version-control">Version Control</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Using developer workspaces</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/workspaces-overview">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/configuring-a-workspace-using-a-devfile">Configuring a workspace using a devfile</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/making-a-workspace-portable-using-a-devfile">Making a workspace portable using a devfile</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/converting-a-che-6-workspace-to-a-che-7-devfile">Converting a Che 6 Workspace to a Che 7 devfile</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/creating-and-configuring-a-new-che-7-workspace">Creating and configuring a new Che 7 workspace</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/importing-a-kubernetes-application-into-a-che-workspace">Importing a Kubernetes application into a Che workspace</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/remotely-accessing-che-workspaces">Remotely accessing workspaces</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/creating-a-workspace-from-code-sample">Creating a workspace from code sample</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/creating-a-workspace-by-importing-source-code-of-a-project">Creating a workspace by importing source code of a project</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Customizing developer environments</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/customizing-developer-environments">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/what-is-a-che-theia-plug-in">What is a Che-Theia plug-in</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/using-alternative-ides-in-che">Using alternative IDEs in Che</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/using-a-visual-studio-code-extension-in-che">Using a VS Code extension in Che</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
  <div class="sidebarSubtitle">Installation Guide</div>
  
  
  <li>
      
      <a href="/che/docs/che-7/updating-che">Updating Che</a>
      
      <ul>
          
      </ul>
   </li>
     
      
      
  <div class="sidebarSubtitle">Administration Guide</div>
  
  
  <li>
      
      <a href="#" class="expandable">Customizing devfile and plug-in registries</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/customizing-the-devfile-and-plug-in-registries">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/building-and-running-a-custom-registry-image">Building and running a custom registry image</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/including-the-plug-in-binaries-in-the-registry-image">Including the plug-in binaries in the registry image</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/editing-a-devfile-and-plug-in-at-runtime">Editing a devfile and plug-in at runtime</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Retrieving Che logs</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/retrieving-che-logs">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/viewing-kubernetes-events">Viewing Kubernetes events</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/viewing-che-server-logs">Viewing Che server logs</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/viewing-external-service-logs">Viewing external service logs</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/viewing-che-workspaces-logs">Viewing Che workspaces logs</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/viewing-plug-in-broker-logs">Viewing the plug-in broker logs</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che/docs/che-7/monitoring-che">Monitoring Che</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che/docs/che-7/tracing-che">Tracing Che</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Securing Che</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/securing-che">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/authenticating-users">Authenticating users</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/authorizing-users">Authorizing users</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
  <div class="sidebarSubtitle">Contributor Guide</div>
  
  
  <li>
      
      <a href="/che/docs/che-7/developing-che-theia-plug-ins">Developing Che-Theia plug-ins</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che/docs/che-7/testing-che-theia-plug-ins">Testing Che-Theia plug-ins</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che/docs/che-7/publishing-che-theia-plug-ins">Publishing Che-Theia plug-ins</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che/docs/che-7/adding-support-for-a-new-language">Adding support for a new language</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che/docs/che-7/adding-support-for-a-new-debugger">Adding support for a new debugger</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Che extensibility reference</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/che-extensibility-reference">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che-extension-points">Che extension points</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che-theia-plug-in-api">Che-Theia plug-in API</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/debug-adapter-protocol">Debug Adapter Protocol</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/language-server-protocol">Language Server Protocol</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
  <div class="sidebarSubtitle">Extensions</div>
  
  
  <li>
      
      <a href="#" class="expandable">Eclipse Che4z</a>
      
      <ul>
          
          
          
          <li><a href="/che/docs/che-7/eclipse-che4z">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che4z-release-information">Release Information</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che4z-installing">Installing</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che4z-using-explorer-for-zos">Using z/OS Resource Explorer</a></li>
          
          
          
          
          
          
          <li><a href="/che/docs/che-7/che4z-product-accessibility-features">Product Accessibility Features</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block: -->
         <p class="external">
             <a href="#" id="collapseAll">Collapse all</a> | <a href="#" id="expandAll">Expand all</a>
         </p>
         
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>

            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Making a workspace portable using a Devfile</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.
$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2' });
/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top
  $(window).scrollTop(scroll_target - 10);
  return false
})

});
</script>

<div id="toc"></div>

    


    <!-- 


     -->

  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>To transfer a configured Che  workspace, create and export the devfile of the workspace and load the devfile on a different host to initialize a new instance of the workspace. For detailed instructions on how to create such a devfile, see below.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-is-a-devfile_making-a-workspace-portable-using-a-devfile">What is a devfile</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A devfile is a file that describes and define a development environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the source code</p>
</li>
<li>
<p>the development components (browser IDE tools and application runtimes)</p>
</li>
<li>
<p>a list of pre-defined commands</p>
</li>
<li>
<p>projects to clone</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Devfiles are YAML files that Che consumes and transforms into a cloud workspace composed of multiple containers. The devfile can be saved in the root folder of a Git repository, a feature branch of a Git repository, a publicly accessible destination, or as a separate, locally stored artifact.</p>
</div>
<div class="paragraph">
<p>When creating a workspace, Che uses that definition to initiate everything and run all the containers for the required tools and application runtimes. Che also mounts file-system volumes to make source code available to the workspace.</p>
</div>
<div class="paragraph">
<p>Devfiles can be versioned with the project source code. When there is a need for a workspace to fix an old maintenance branch, the project devfile provides a definition of the workspace with the tools and the exact dependencies to start working on the old branch. Use it to instantiate workspaces on demand.</p>
</div>
<div class="paragraph">
<p>Che maintains the devfile up-to-date with the tools used in the workspace:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Projects of the workspace (path, Git location, branch)</p>
</li>
<li>
<p>Commands to perform daily tasks (build, run, test, debug)</p>
</li>
<li>
<p>Runtime environment (container images to run the application)</p>
</li>
<li>
<p>Che-Theia plug-ins with tools, IDE features, and helpers that a developer would use in the workspace (Git, Java support, Sonarlint, Pull Request)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="a-minimal-devfile_making-a-workspace-portable-using-a-devfile">A minimal devfile</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following is the minimum content required in a <code>devfile.yaml</code> file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://redhat-developer.github.io/devfile/devfile#apiversion">apiVersion</a></p>
</li>
<li>
<p><a href="https://redhat-developer.github.io/devfile/devfile#metadata">metadata name</a></p>
</li>
<li>
<p><a href="https://redhat-developer.github.io/devfile/devfile#projects">projects name and source</a></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">che-in-che-out</span></span>
<span style="color:#606">projects</span>:
  - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: che</span></span>
    <span style="color:#606">source</span>:
      <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">git</span></span>
      <span style="color:#606">location</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'https://github.com/eclipse/che.git'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete devfile example, see <a href="https://github.com/eclipse/che/blob/master/devfile.yaml">Eclipse Che in Che devfile.yaml</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="writing-a-devfile-for-your-project_making-a-workspace-portable-using-a-devfile">Writing a devfile for a project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes how to create a minimal devfile for your project and how to include more than one projects in a devfile.</p>
</div>
<div class="sect2">
<h3 id="preparing-a-minimal-devfile_making-a-workspace-portable-using-a-devfile">Preparing a minimal devfile</h3>
<div class="paragraph">
<p>A minimal devfile sufficient to run a workspace consists of the following parts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specification version</p>
</li>
<li>
<p>Name</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example of a minimal devfile with no project</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">minimal-workspace</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Without any further configuration, a workspace with the default editor is launched along with its default plug-ins, which are configured on the Che Server. Che-Theia is configured as the default editor along with the <strong>Che Machine Exec</strong> plug-in.</p>
</div>
<div class="paragraph">
<p>Add the following parts for a more functional workspace:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>List of components: Development components and user runtimes</p>
</li>
<li>
<p>List of projects: Source code repositories</p>
</li>
<li>
<p>List of commands: Actions to manage the workspace components, such as running the development tools, starting the runtime environments, and others</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example of a minimal devfile with a project</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">petclinic-dev-environment</span></span>
<span style="color:#606">projects</span>:
  - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: petclinic</span></span>
    <span style="color:#606">source</span>:
      <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">git</span></span>
      <span style="color:#606">location</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'https://github.com/spring-projects/spring-petclinic.git'</span></span>
<span style="color:#606">components</span>:
  - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">type: chePlugin</span></span>
    <span style="color:#606">id</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">redhat/java/latest</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="specifying-multiple-projects-in-a-devfile_making-a-workspace-portable-using-a-devfile">Specifying multiple projects in a devfile</h3>
<div class="paragraph">
<p>A single devfile can specify multiple projects. For each project, specify the type of the source repository, its location, and optionally also the directory to which the project should be cloned to.</p>
</div>
<div class="listingblock">
<div class="title">Example of a devfile with two projects</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">example-devfile</span></span>
<span style="color:#606">projects</span>:
- <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: frontend</span></span>
  <span style="color:#606">source</span>:
    <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">git</span></span>
    <span style="color:#606">location</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">https://github.com/acmecorp/frontend.git</span></span>
- <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: backend</span></span>
  <span style="color:#606">clonePath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">src/github.com/acmecorp/backend</span></span>
  <span style="color:#606">source</span>:
    <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">git</span></span>
    <span style="color:#606">location</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">https://github.com/acmecorp/backend.git</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the preceding example, there are two projects defined, <code>frontend</code> and <code>backend</code>. Each project is located in its own repository. The <code>backend</code> project has a specific requirement to be cloned into the <code>src/github.com/acmecorp/backend/</code> directory under the source root (implicitly defined by the Che runtime) while the <code>frontend</code> project will be cloned into the <code>frontend/</code> directory under the source root.</p>
</div>
<div class="paragraph">
<div class="title">Additional resources</div>
<p>For a detailed explanation of all devfile component assignments and possible values, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/redhat-developer/devfile">Specification repository</a></p>
</li>
<li>
<p><a href="https://redhat-developer.github.io/devfile/devfile">Detailed json-schema documentation</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These sample devfiles are a good source of inspiration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/eclipse/che-devfile-registry/tree/master/devfiles">Sample devfiles for Eclipse Che workspaces used by default in the user interface</a>.</p>
</li>
<li>
<p><a href="https://github.com/redhat-developer/devfile/tree/master/samples">Sample devfiles for Eclipse Che workspaces from Red Hat Developer program</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devfile-reference_making-a-workspace-portable-using-a-devfile">Devfile reference</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section contains devfile reference and instructions on how to use the various elements that devfiles consist of.</p>
</div>
<div class="sect2">
<h3 id="adding-components-to-a-devfile">Adding components to a devfile</h3>
<div class="paragraph">
<p>Each component in a single devfile must have a unique name.</p>
</div>
<div class="sect3">
<h4 id="component-type-cheeditor">Component type: cheEditor</h4>
<div class="paragraph">
<p>Describes the editor used in the workspace by defining its <code>id</code>. A devfile can only contain one component of the <code>cheEditor</code> type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">components</span>:
  - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">alias: theia-editor</span></span>
    <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">cheEditor</span></span>
    <span style="color:#606">id</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">eclipse/che-theia/next</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When <code>cheEditor</code> is missing, a default editor is provided along with its default plug-ins. The default plug-ins are also provided for an explicitly defined editor with the same <code>id</code> as the default one (even if it is a different version). Che-Theia is configured as default editor along with the <strong>Che Machine Exec</strong> plug-in.</p>
</div>
<div class="paragraph">
<p>To specify that a workspace requires no editor, use the <a href="#attribute-editorfree_making-a-workspace-portable-using-a-devfile"><code>editorFree:true</code> attribute</a> in the devfile attributes.</p>
</div>
</div>
<div class="sect3">
<h4 id="component-type-cheplugin">Component type: chePlugin</h4>
<div class="paragraph">
<p>Describes plug-ins in a workspace by defining their <code>id</code>. It is allowed to have several <code>chePlugin</code> components.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">  <span style="color:#606">components</span>:
   - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">alias: exec-plugin</span></span>
     <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">chePlugin</span></span>
     <span style="color:#606">id</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">eclipse/che-machine-exec-plugin/0.0.1</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Both types above using id, which is slash-separated publisher, name and version of plugin from Che Plugin registry.<br>
List of available Che plugins and more information about registry can be found in the <a href="https://github.com/eclipse/che-plugin-registry">Che plug-in registry</a> GitHub repository.</p>
</div>
</div>
<div class="sect3">
<h4 id="specifying-an-alternative-component-registry">Specifying an alternative component registry</h4>
<div class="paragraph">
<p>To specify an alternative registry for the <code>cheEditor</code> and <code>chePlugin</code> component types, use the <code>registryUrl</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">  <span style="color:#606">components</span>:
   - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">alias: exec-plugin</span></span>
     <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">chePlugin</span></span>
     <span style="color:#606">registryUrl</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">https://my-customregistry.com</span></span>
     <span style="color:#606">id</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">eclipse/che-machine-exec-plugin/0.0.1</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="specifying-a-component-by-linking-to-its-descriptor">Specifying a component by linking to its descriptor</h4>
<div class="paragraph">
<p>An alternative way of specifying <code>cheEditor</code> or <code>chePlugin</code>, instead of using the editor or plug-in <code>id</code> (and optionally an alternative registry), is to provide a direct link to the component descriptor (typically named <code>meta.yaml</code>) by using the <code>reference</code> field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">  <span style="color:#606">components</span>:
   - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">alias: exec-plugin</span></span>
     <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">chePlugin</span></span>
     <span style="color:#606">reference</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">https://raw.githubusercontent.com.../plugin/1.0.1/meta.yaml</span></span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is not possible to mix the <code>id</code> and <code>reference</code> fields in a single component definition; they are mutually exclusive.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="specifying-container-memory-limit-for-components">Specifying container memory limit for components</h4>
<div class="paragraph">
<p>To specify a container(s) memory limit for <code>cheEditor</code> or <code>chePlugin</code>, use the <code>memoryLimit</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">  <span style="color:#606">components</span>:
   - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">alias: exec-plugin</span></span>
     <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">chePlugin</span></span>
     <span style="color:#606">id</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">eclipse/che-machine-exec-plugin/0.0.1</span></span>
     <span style="color:#606">memoryLimit</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">256M</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This limit will be applied to every container of the given component.</p>
</div>
</div>
<div class="sect3">
<h4 id="tuning-component-configuration">Tuning component configuration</h4>
<div class="paragraph">
<p>A component may need to be precisely tuned, and in such case, component preferences can be used. The example shows how to configure JVM using plug-in preferences.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">  <span style="color:#606">id</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">redhat/java/0.38.0</span></span>
  <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">chePlugin</span></span>
  <span style="color:#606">preferences</span>:
     <span style="color:#606">java.jdt.ls.vmargs</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'-noverify -Xmx1G -XX:+UseG1GC -XX:+UseStringDeduplication'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="component-type-kubernetes">Component type: kubernetes</h4>
<div class="paragraph">
<p>A complex component type that allows to apply configuration from a Kubernetes or OpenShift lists. The content of the component can be provided either via the <code>reference</code> attribute, which points to the file with the component content.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">  <span style="color:#606">components</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">alias: mysql</span></span>
      <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">kubernetes</span></span>
      <span style="color:#606">reference</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">petclinic.yaml</span></span>
      <span style="color:#606">selector</span>:
        <span style="color:#606">app.kubernetes.io/name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">mysql</span></span>
        <span style="color:#606">app.kubernetes.io/component</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">database</span></span>
        <span style="color:#606">app.kubernetes.io/part-of</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">petclinic</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, to post a devfile with such components to REST API, the contents of the Kubernetes or OpenShift list can be embedded into the devfile using the <code>referenceContent</code> field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">  <span style="color:#606">components</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">alias: mysql</span></span>
      <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">kubernetes</span></span>
      <span style="color:#606">reference</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">petclinic.yaml</span></span>
      <span style="color:#606">referenceContent</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">|</span><span style="color:#D20">
           kind: List
           items:
            -
             apiVersion: v1
             kind: Pod
             metadata:
              name: ws
             spec:
              containers:
              ... etc</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As with the <a href="#component-type-dockerimage_making-a-workspace-portable-using-a-devfile"><code>dockerimage</code> component</a>, it is possible to override the entrypoint of the containers contained in the Kubernetes or OpenShift list using the <code>command</code> and <code>args</code> properties (as <a href="https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/#notes">understood</a> by Kubernetes).</p>
</div>
<div class="paragraph">
<p>There can be more containers in the list (contained in pods or pod templates of deployments). To select which containers to apply the entrypoint changes to.</p>
</div>
<div class="paragraph">
<p>The entrypoints can be defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">  <span style="color:#606">components</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">alias: appDeployment</span></span>
      <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">kubernetes</span></span>
      <span style="color:#606">reference</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">app-deployment.yaml</span></span>
      <span style="color:#606">entrypoints</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">parentName: mysqlServer</span></span>
        <span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">['sleep']</span></span>
        <span style="color:#606">args</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">['infinity']</span></span>
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">parentSelector:</span><span style="color:#D20">
          app: prometheus</span></span>
        <span style="color:#606">args</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">['-f', '/opt/app/prometheus-config.yaml']</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>entrypoints</code> list contains constraints for picking the containers along with the <code>command</code> and <code>args</code> parameters to apply to them. In the example above, the constraint is <code>parentName: mysqlServer</code>, which will cause the command to be applied to all containers defined in any parent object called <code>mysqlServer</code>. The parent object is assumed to be a top level object in the list defined in the referenced file, which is <code>app-deployment.yaml</code> in the example above.</p>
</div>
<div class="paragraph">
<p>Other types of constraints (and their combinations) are possible:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>containerName</code></dt>
<dd>
<p>the name of the container</p>
</dd>
<dt class="hdlist1"><code>parentName</code></dt>
<dd>
<p>the name of the parent object that (indirectly) contains the containers to override</p>
</dd>
<dt class="hdlist1"><code>parentSelector</code></dt>
<dd>
<p>the set of labels the parent object needs to have</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A combination of these constraints can be used to precisely locate the containers inside the referenced Kubernetes list.</p>
</div>
</div>
<div class="sect3">
<h4 id="specifying-mount-sources-option">Specifying mount sources option</h4>
<div class="paragraph">
<p>To specify a project sources directory mount into container(s), use the <code>mountSources</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">   <span style="color:#606">components</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">alias: appDeployment</span></span>
        <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">kubernetes</span></span>
        <span style="color:#606">reference</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">app-deployment.yaml</span></span>
        <span style="color:#606">mountSources</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">true</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If enabled, project sources mounts will be applied to every container of the given component.
This parameter is also applicable for <code>chePlugin</code> type components.</p>
</div>
</div>
<div class="sect3">
<h4 id="component-type-dockerimage_making-a-workspace-portable-using-a-devfile">Component type: dockerimage</h4>
<div class="paragraph">
<p>A component type that allows to define a container image-based configuration of a container in a workspace. A devfile can only contain one component of the <code>dockerimage</code> type. The <code>dockerimage</code> type of component brings in custom tooling into the workspace. The component is identified by its image.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"> <span style="color:#606">components</span>:
   - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">alias: maven</span></span>
     <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">dockerimage</span></span>
     <span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">eclipe/maven-jdk8:latest</span></span>
     <span style="color:#606">volumes</span>:
       - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: mavenrepo</span></span>
         <span style="color:#606">containerPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/root/.m2</span></span>
     <span style="color:#606">env</span>:
       - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: ENV_VAR</span></span>
         <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">value</span></span>
     <span style="color:#606">endpoints</span>:
       - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: maven-server</span></span>
         <span style="color:#606">port</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">3101</span></span>
         <span style="color:#606">attributes</span>:
           <span style="color:#606">protocol</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">http</span></span>
           <span style="color:#606">secure</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'true'</span></span>
           <span style="color:#606">public</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'true'</span></span>
           <span style="color:#606">discoverable</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'false'</span></span>
     <span style="color:#606">memoryLimit</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1536M</span></span>
     <span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">['tail']</span></span>
     <span style="color:#606">args</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">['-f', '/dev/null']</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example of a minimal <code>dockerimage</code> component</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">MyDevfile</span></span>
<span style="color:#606">components</span>:
<span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">dockerimage</span></span>
<span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">golang</span></span>
<span style="color:#606">memoryLimit</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">512Mi</span></span>
<span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">['sleep', 'infinity']</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It specifies the type of the component, <code>dockerimage</code> and the <code>image</code> attribute names the image to be used for the component using the usual docker naming conventions, that is, the above <code>type</code> attribute is equal to <code>docker.io/library/golang:latest</code>.</p>
</div>
<div class="paragraph">
<p>A <code>dockerimage</code> component has many features that enable augmenting the image with additional resources and information needed for meaningful integration of the <strong>tool</strong> provided by the image with Eclipse Che.</p>
</div>
<div class="sect4">
<h5 id="mounting-project-sources">Mounting project sources</h5>
<div class="paragraph">
<p>For the <code>dockerimage</code> component to have access to the project sources, you must set the <code>mountSources</code> attribute to <code>true</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">MyDevfile</span></span>
<span style="color:#606">components</span>:
<span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">dockerimage</span></span>
<span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">golang</span></span>
<span style="color:#606">memoryLimit</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">512Mi</span></span>
<span style="color:#606">mountSources</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">true</span></span>
<span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">['sleep', 'infinity']</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The sources is mounted on a location stored in the <code>CHE_PROJECTS_ROOT</code> environment variable that is made available in the running container of the image. This location defaults to <code>/projects</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="container-entrypoint">Container Entrypoint</h5>
<div class="paragraph">
<p>The <code>command</code> attribute of the <code>dockerimage</code> along with other arguments, is used to modify the <code>entrypoint</code> command of the container created from the image. In Eclipse Che the container is needed to run indefinitely so that you can connect to it and execute arbitrary commands in it at any time. Because the availability of the <code>sleep</code> command and the support for the <code>infinity</code> argument for it is different and depends on the base image used in the particular images, Che cannot insert this behavior automatically on its own. However, you can take advantage of this feature to, for example, start up necessary servers with modified configurations, etc.</p>
</div>
</div>
<div class="sect4">
<h5 id="persistent-storage">Persistent Storage</h5>
<div class="paragraph">
<p>Docker image tools can specify the custom volumes to be mounted on specific locations within the image. Note that the volume names are shared across all components and therefore this mechanism can also be used to share file systems between components.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">MyDevfile</span></span>
<span style="color:#606">components</span>:
<span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">dockerimage</span></span>
<span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">golang</span></span>
<span style="color:#606">memoryLimit</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">512Mi</span></span>
<span style="color:#606">mountSources</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">true</span></span>
<span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">['sleep', 'infinity']</span></span>
<span style="color:#606">volumes</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: cache</span></span>
      <span style="color:#606">containerPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/.cache</span></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="environment">Environment</h5>
<div class="paragraph">
<p>Eclipse Che allows you to configure Docker containers by modifying the environment variables available in the container of an image.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">MyDevfile</span></span>
<span style="color:#606">projects</span>:
<span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">my-go-project</span></span>
<span style="color:#606">source</span>:
    <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">git</span></span>
    <span style="color:#606">location</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">https://github.com/acme/my-go-project.git</span></span>
    <span style="color:#606">clonePath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">go/src/github.com/acme/my-go-project</span></span>
<span style="color:#606">components</span>:
<span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">dockerimage</span></span>
<span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">golang</span></span>
<span style="color:#606">memoryLimit</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">512Mi</span></span>
<span style="color:#606">mountSources</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">true</span></span>
<span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">['sleep', 'infinity']</span></span>
<span style="color:#606">env</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: GOPATH</span></span>
      <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">$(CHE_PROJECTS_ROOT)/go</span></span>
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: GOCACHE</span></span>
      <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/tmp/go-cache</span></span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The variable expansion works between the environment variables and it uses the Kubernetes convention for the variable references.</p>
</li>
<li>
<p>You can use the predefined variables in your own definitions.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following environment variables are pre-set by the Che server:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CHE_PROJECTS_ROOT</code>: The location of the projects directory (note that if the component does not mount the sources, the projects will not be accessible).</p>
</li>
<li>
<p><code>CHE_WORKSPACE_LOGS_ROOT__DIR</code>: The location of the logs common to all the components. If the component chooses to put logs into this directory, the log files are accessible from all other components.</p>
</li>
<li>
<p><code>CHE_API_INTERNAL</code>: The URL to the Che server API endpoint used for communication with the Che server.</p>
</li>
<li>
<p><code>CHE_WORKSPACE_ID</code>: The ID of the current workspace.</p>
</li>
<li>
<p><code>CHE_WORKSPACE_NAME</code>: The name of the current workspace.</p>
</li>
<li>
<p><code>CHE_WORKSPACE_NAMESPACE</code>: The namespace of the current workspace.</p>
</li>
<li>
<p><code>CHE_MACHINE_TOKEN</code>: The token used to authenticate the request against the Che server.</p>
</li>
<li>
<p><code>CHE_MACHINE_AUTH_SIGNATURE<em>PUBLIC</em>KEY</code>: The public key used to secure the communication with the Che server.</p>
</li>
<li>
<p><code>CHE_MACHINE_AUTH_SIGNATURE__ALGORITHM</code>: The encryption algorithm used in the secured communication with the Che server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A devfiles may only need the <code>CHE_PROJECTS_ROOT</code> environment variable to locate the cloned projects in the component&#8217;s container. More advanced devfiles might use the <code>CHE_WORKSPACE_LOGS_ROOT__DIR</code> environment variable to read the logs (for example as part of a devfile command). The environment variables used to securely access the Che server are mostly out of scope for devfiles and are present only for advanced use cases that are usually handled by the Che plug-ins.</p>
</div>
</div>
<div class="sect4">
<h5 id="endpoints">Endpoints</h5>
<div class="paragraph">
<p>You can specify the endpoints that the docker image exposes. These endpoints can be made accessible to the users if the Che cluster is running using a Kubernetes ingress or an OpenShift route and to the other components within the workspace. You can create an endpoint for your application or database, if your application or database server is listening on a port and you want to be able to directly interact with it yourself or you want other components to interact with it.</p>
</div>
<div class="paragraph">
<p>Endpoints have a number of properties as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">MyDevfile</span></span>
<span style="color:#606">projects</span>:
<span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">my-go-project</span></span>
<span style="color:#606">source</span>:
    <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">git</span></span>
    <span style="color:#606">location</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">https://github.com/acme/my-go-project.git</span></span>
    <span style="color:#606">clonePath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">go/src/github.com/acme/my-go-project</span></span>
<span style="color:#606">components</span>:
<span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">dockerimage</span></span>
<span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">golang</span></span>
<span style="color:#606">memoryLimit</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">512Mi</span></span>
<span style="color:#606">mountSources</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">true</span></span>
<span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">['sleep', 'infinity']</span></span>
<span style="color:#606">env</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: GOPATH</span></span>
      <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">$(CHE_PROJECTS_ROOT)/go</span></span>
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: GOCACHE</span></span>
      <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/tmp/go-cache</span></span>
<span style="color:#606">endpoints</span>:
<span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">web</span><span style="color:#D20">
    port: 8080
    attributes:
        discoverable: false
        public: true
        protocol: http</span></span>
<span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">dockerimage</span></span>
<span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span></span>
<span style="color:#606">memoryLimit</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">512Mi</span></span>
<span style="color:#606">env</span>:
<span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">POSTGRES_USER</span></span>
<span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">user</span></span>
<span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">POSTGRES_PASSWORD</span></span>
<span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">password</span></span>
<span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">POSTGRES_DB</span><span style="color:#D20">
    value: database</span></span>
<span style="color:#606">endpoints</span>:
<span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span><span style="color:#D20">
    port: 5432
    attributes:
        discoverable: true
        public: false</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, there are two dockerimages, each defining a single endpoint. Endpoint is an accessible port that can be made accessible inside the workspace or also publicly (example, from the UI). Each endpoint has a name and port, which is the port on which certain server running inside the container is listening. The following are a few attributes that you can set on the endpoint:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>discoverable</code>: If an endpoint is discoverable, it means that it can be accessed using its name as the hostname within the workspace containers (in the Kubernetes parlance, a service is created for it with the provided name).</p>
</li>
<li>
<p><code>public</code>: The endpoint will be accessible outside of the workspace, too (such endpoint can be accessed from the Che user interface). Such endpoints are publicized always on port <code>80</code> or <code>443</code> (depending on whether <code>tls</code> is enabled in Che).</p>
</li>
<li>
<p><code>protocol</code>: For public endpoints the protocol is a hint to the UI on how to construct the URL for the endpoint access. Typical values are <code>http</code>, <code>https</code>, <code>ws</code>, <code>wss</code>.</p>
</li>
<li>
<p><code>secure</code>: A boolean (defaulting to <code>false</code>) specifying whether the endpoint is put behind a JWT proxy requiring a JWT workspace token to grant access.</p>
</li>
<li>
<p><code>path</code>: The URL of the endpoint</p>
</li>
<li>
<p><code>unsecuredPaths</code>: A comma-separated list of paths in the endpoint that should not be secured, even if the <code>secure</code> attribute is set to <code>true</code></p>
</li>
<li>
<p><code>cookiesAuthEnabled</code>: When set to <code>true</code> (the default is <code>false</code>), the JWT workspace token is automatically fetched and included in a workspace-specific cookie to allow requests to pass through the JWT proxy.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This setting potentially allows a <a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery">CSRF</a> attack when used in conjunction with a server using POST requests.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>When starting a new server within a component, Che autodetects this, and the UI offers to automatically expose this port as a <code>public</code> port. This is useful for debugging a web application, for example. It is not possible to do this for servers that autostart with the container (for example, a database server). For such components, specify the endpoints explicitly.</p>
</div>
</div>
<div class="sect4">
<h5 id="kubernetes-and-openshift-resources">Kubernetes and OpenShift resources</h5>
<div class="paragraph">
<p>Complex deployments can be described using Kubernetes or OpenShift resource lists that can be referenced in the devfile. This will make them part of the workspace.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Because a Che workspace is internally represented as a single deployment, all resources from the Kubernetes or OpenShift list are merged into that single deployment.</p>
</li>
<li>
<p>You must be careful when designing such lists because this can result in name conflicts and other problems.</p>
</li>
<li>
<p>Only the following subset of the Kubernetes objects are supported: <code>deployments</code>, <code>pods</code>, <code>services</code>, <code>persistent volume claims</code>, <code>secrets</code>, and <code>config maps</code>. Kubernetes ingresses are ignored but OpenShift routes are supported. A workspace created from a devfile using any other object types will fail to start.</p>
</li>
<li>
<p>If you run Che on a Kubernetes cluster, only Kubernetes lists are supported. However, if you run Che on an OpenShift cluster, both Kubernetes and OpenShift lists are supported (because OpenShift is a superset of Kubernetes).</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">MyDevfile</span></span>
<span style="color:#606">projects</span>:
<span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">my-go-project</span></span>
<span style="color:#606">source</span>:
    <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">git</span></span>
    <span style="color:#606">location</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">https://github.com/acme/my-go-project.git</span></span>
    <span style="color:#606">clonePath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">go/src/github.com/acme/my-go-project</span></span>
<span style="color:#606">components</span>:
<span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">kubernetes</span></span>
<span style="color:#606">reference</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">../relative/path/postgres.yaml</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding component references a file that is relative to the location of the devfile itself. Meaning, this devfile is only loadable by a Che factory to which you supply the location of the devfile and therefore it is able to figure out the location of the referenced Kubernetes resource list.</p>
</div>
<div class="paragraph">
<p>The following is an example of the <code>postgres.yaml</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">List</span></span>
<span style="color:#606">items</span>:
-
    <span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
    <span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Deployment</span></span>
    <span style="color:#606">metadata</span>:
        <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span></span>
        <span style="color:#606">labels</span>:
            <span style="color:#606">app</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span></span>
    <span style="color:#606">spec</span>:
        <span style="color:#606">template</span>:
        <span style="color:#606">metadata</span>:
            <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span></span>
            <span style="color:#606">app</span>:
                <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span></span>
        <span style="color:#606">spec</span>:
            <span style="color:#606">containers</span>:
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">image: postgres</span></span>
              <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span></span>
              <span style="color:#606">ports</span>:
              - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: postgres</span></span>
                <span style="color:#606">containerPort</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">5432</span></span>
                <span style="color:#606">volumeMounts</span>:
                - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: pg-storage</span></span>
                  <span style="color:#606">mountPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/var/lib/postgresql/data</span></span>
            <span style="color:#606">volumes</span>:
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: pg-storage</span></span>
              <span style="color:#606">persistentVolumeClaim</span>:
                  <span style="color:#606">claimName</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">pg-storage</span></span>
-
    <span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
    <span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Service</span></span>
    <span style="color:#606">metadata</span>:
        <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span></span>
        <span style="color:#606">labels</span>:
            <span style="color:#606">app</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span></span>
            <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span></span>
    <span style="color:#606">spec</span>:
        <span style="color:#606">ports</span>:
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">port: 5432</span></span>
              <span style="color:#606">targetPort</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">5432</span></span>
        <span style="color:#606">selector</span>:
            <span style="color:#606">app</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span></span>
-
    <span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
    <span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">PersistentVolumeClaim</span></span>
    <span style="color:#606">metadata</span>:
        <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">pg-storage</span></span>
      <span style="color:#606">labels</span>:
        <span style="color:#606">app</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span></span>
    <span style="color:#606">spec</span>:
        <span style="color:#606">accessModes</span>:
         - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">ReadWriteOnce</span></span>
        <span style="color:#606">resources</span>:
            <span style="color:#606">requests</span>:
                <span style="color:#606">storage</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1Gi</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For a basic example of a devfile with an associated Kubernetes or OpenShift list, see <a href="https://github.com/redhat-developer/devfile/tree/master/samples/web-nodejs-with-db-sample">web-nodejs-with-db-sample</a> on redhat-developer GitHub.</p>
</div>
<div class="paragraph">
<p>If you use generic or large resource lists from which you will only need a subset of resources, you can select particular resources from the list using a selector (which, as the usual Kubernetes selectors, works on the labels of the resources in the list).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">MyDevfile</span></span>
<span style="color:#606">projects</span>:
<span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">my-go-project</span></span>
<span style="color:#606">source</span>:
    <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">git</span></span>
    <span style="color:#606">location</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">https://github.com/acme/my-go-project.git</span></span>
    <span style="color:#606">clonePath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">go/src/github.com/acme/my-go-project</span></span>
<span style="color:#606">components</span>:
<span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">kubernetes</span></span>
<span style="color:#606">reference</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">../relative/path/postgres.yaml</span></span>
<span style="color:#606">selector</span>:
    <span style="color:#606">app</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">postgres</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, it is also possible to modify the entrypoints (command and arguments) of the containers present in the resource list. For details of the advanced use case, see the reference (TODO: link).</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-commands-to-a-devfile">Adding commands to a devfile</h3>
<div class="paragraph">
<p>A devfile allows to specify commands to be available for execution in a workspace. Every command can contain a subset of actions, which are related to a specific component in whose container it will be executed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"> <span style="color:#606">commands</span>:
   - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: build</span></span>
     <span style="color:#606">actions</span>:
       - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">type: exec</span></span>
         <span style="color:#606">component</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">mysql</span></span>
         <span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">mvn clean</span></span>
         <span style="color:#606">workdir</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/projects/spring-petclinic</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use commands to automate the workspace. You can define commands for building and testing your code, or cleaning the database.</p>
</div>
<div class="paragraph">
<p>The following are two kinds of commands:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Che specific commands: You have full control over what component executes the command.</p>
</li>
<li>
<p>Editor specific commands: You can use the editor-specific command definitions (example: <code>tasks.json</code> and <code>launch.json</code> in Theia, which is equivalent to how these files work in VS Code).</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="che-specific-commands">Che-specific commands</h4>
<div class="paragraph">
<p>Each che-specific command has an <strong>action</strong> attribute that is a command to execute and a <strong>component</strong> attribute that specifies the container in which the command should be executed. The commands are run using the default shell in the container.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">MyDevfile</span></span>
<span style="color:#606">projects</span>:
<span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">my-go-project</span></span>
<span style="color:#606">source</span>:
    <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">git</span></span>
    <span style="color:#606">location</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">https://github.com/acme/my-go-project.git</span></span>
    <span style="color:#606">clonePath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">go/src/github.com/acme/my-go-project</span></span>
<span style="color:#606">components</span>:
<span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">dockerimage</span></span>
<span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">golang</span></span>
<span style="color:#606">alias</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">go-cli</span></span>
<span style="color:#606">memoryLimit</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">512Mi</span></span>
<span style="color:#606">mountSources</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">true</span></span>
<span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">['sleep', 'infinity']</span></span>
<span style="color:#606">env</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: GOPATH</span></span>
      <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">$(CHE_PROJECTS_ROOT)/go</span></span>
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: GOCACHE</span></span>
      <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/tmp/go-cache</span></span>
<span style="color:#606">commands</span>:
- <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: compile and run</span></span>
  <span style="color:#606">actions</span>:
  - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">type: exec</span></span>
    <span style="color:#606">component</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">go-cli</span></span>
    <span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">go get -d &amp;&amp; go run main.go</span></span>
    <span style="color:#606">workdir</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">${CHE_PROJECTS_ROOT}/src/github.com/acme/my-go-project</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>If a component to be used in a command must have an alias. This alias is used to reference the component in the command definition. Example: <code>alias: go-cli</code> in the component definition and <code>component: go-cli</code> in the command definition. This ensures that Eclipse Che can find the correct container to run the command in.</p>
</li>
<li>
<p>A command can have only one action.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="editor-specific-commands">Editor-specific commands</h4>
<div class="paragraph">
<p>If the editor in the workspace supports it, the devfile can specify additional configuration in the editor-specific format. This is dependent on the integration code present in the workspace editor itself and so is not a generic mechanism. However, the default Theia editor within Eclipse Che is equipped to understand the <code>tasks.json</code> and <code>launch.json</code> files provided in the devfile.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">MyDevfile</span></span>
<span style="color:#606">projects</span>:
<span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">my-go-project</span></span>
<span style="color:#606">source</span>:
    <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">git</span></span>
    <span style="color:#606">location</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">https://github.com/acme/my-go-project.git</span></span>
    <span style="color:#606">clonePath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">go/src/github.com/acme/my-go-project</span></span>
<span style="color:#606">commands</span>:
        - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: tasks</span></span>
          <span style="color:#606">actions</span>:
          - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">type: vscode-task</span></span>
            <span style="color:#606">referenceContent</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&gt;</span><span style="color:#D20">
                {
                    &quot;version&quot;: &quot;2.0.0&quot;,
                    &quot;tasks&quot;: [
                        {
                            &quot;label&quot;: &quot;create test file&quot;,
                            &quot;type&quot;: &quot;shell&quot;,
                            &quot;command&quot;: &quot;touch ${workspaceFolder}/test.file&quot;
                        }
                    ]
                }</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This example shows association of a <code>tasks.json</code> file with a devfile. Notice the <code>vscode-task</code> type that instructs the Che-Theia editor to interpret this command as a tasks definition and <code>referenceContent</code> attribute that contains the contents of the file itself. You can also save this file separately from the devfile and use <code>reference</code> attribute to specify a relative or absolute URL to it.</p>
</div>
<div class="paragraph">
<p>In addition to the <code>vscode-task</code> commands, the Che-Theia editor understands <code>vscode-launch</code> type using which you can specify the launch configurations.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="devfile-attributes">Devfile attributes</h3>
<div class="paragraph">
<p>Devfile attributes can be used to configure various features.</p>
</div>
<div class="sect3">
<h4 id="attribute-editorfree_making-a-workspace-portable-using-a-devfile">Attribute: editorFree</h4>
<div class="paragraph">
<p>When an editor is not specified in a devfile, a default is provided. When no editor is needed, the <code>editorFree</code> attribute should be used. The default value is <code>false</code>, and it means that the devfile needs the default editor to be provisioned.</p>
</div>
<div class="listingblock">
<div class="title">Example of a devfile without an editor</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">petclinic-dev-environment</span></span>
<span style="color:#606">components</span>:
  - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">alias: myApp</span></span>
    <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">kubernetes</span></span>
    <span style="color:#606">local</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">my-app.yaml</span></span>
<span style="color:#606">attributes</span>:
  <span style="color:#606">editorFree</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">true</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="attribute-persistvolumes-ephemeral-mode">Attribute: persistVolumes (ephemeral mode)</h4>
<div class="paragraph">
<p>By default, volumes and PVCs specified in a devfile are bound to a host folder to persist data even after a container restart. Sometimes, it may be necessary to disable data persistence, such as when volume backend is slow, and it is needed to make workspace faster. To achieve it, the <code>persistVolumes</code> devfile attribute should be used. The default value is <code>true</code>, and in case of <code>false</code>, <code>emptyDir</code> volumes will be used for configured volumes and PVC.</p>
</div>
<div class="listingblock">
<div class="title">Example of a devfile with ephemeral mode enabled</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">petclinic-dev-environment</span></span>
<span style="color:#606">projects</span>:
  - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: petclinic</span></span>
    <span style="color:#606">source</span>:
      <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">git</span></span>
      <span style="color:#606">location</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">'https://github.com/che-samples/web-java-spring-petclinic.git'</span></span>
<span style="color:#606">attributes</span>:
  <span style="color:#606">persistVolumes</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">false</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="objects-supported-in-eclipse-che">Objects supported in Eclipse Che 7</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following table lists the objects that are partially supported in Eclipse Che 7:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 55.5556%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Object</th>
<th class="tableblock halign-left valign-top">API</th>
<th class="tableblock halign-left valign-top">Kubernetes Infra</th>
<th class="tableblock halign-left valign-top">OpenShift Infra</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pod</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deployment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ConfigMap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PVC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secret</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ingress</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minishift allows you to create Ingress and it works when the host is specified (OpenShift creates a route for it). But, the <code>loadBalancer</code> IP is not provisioned. To add Ingress support for the OpenShift infrastructure node, generate routes based on the provided Ingress.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Route</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenShift</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The OpenShift recipe must be made compatible with the Kubernetes Infrastructure and, instead of the provided route, generate Ingress.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Template</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenShift</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Kubernetes API does not support templates. A workspace with a template in the recipe starts successfully and the default parameters are resolved.</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://redhat-developer.github.io/devfile/devfile">Devfile specifications</a></p>
</li>
</ul>
</div>
</div>
</div>

    <div class="tags">
        
        <b>Tags: </b>
        
        
        
    </div>

<!-- 
 -->

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
                    Eclipse Che - Documentation <br/>
                    Site last generated: Oct 16, 2019 <br/>
                    <hr>
                    <a href="http://www.eclipse.org" target="_blank">Eclipse Foundation</a><br/>
                    <a href="http://www.eclipse.org/legal/privacy.php" target="_blank">Privacy Policy</a><br/>
                    <a href="http://www.eclipse.org/legal/termsofuse.php" target="_blank">Terms of Use</a><br/>
                    <a href="https://www.eclipse.org/legal/epl-2.0/" target="_blank">Eclipse Public License</a><br/>
                    <a href="http://www.eclipse.org/legal" target="_blank">Legal Resources</a><br/>
                </div>
            </div>
</footer>




    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
